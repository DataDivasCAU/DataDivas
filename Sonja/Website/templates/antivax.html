<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>TOP 15 keywords in comments</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: white;
            color: black;
            font-family: Arial, sans-serif;
            text-align: center;
        }
        #chartContainer {
            width: 90%;
            max-width: 1000px;
            margin: 40px auto;
        }
        select {
            padding: 8px 12px;
            font-size: 16px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h2>Top Keywords by year and combined</h2>
    <label for="yearSelect">Select year:</label>
    <select id="yearSelect">
        <option value="all" selected>all years</option>
        <option value="2020">2020</option>
        <option value="2021">2021</option>
        <option value="2022">2022</option>
        <option value="2023">2023</option>
        <option value="2024">2024</option>
        <option value="2025">2025</option>
    </select>

    <div id="chartContainer">
        <canvas id="keywordsChart"></canvas>
    </div>

    <script>
        const rawData = {
            "2020": [["die", 27],["vaccine", 25],["pray", 12],["children", 11],["child", 11],["doctors", 10],["baby", 10],["parents", 9],["good", 9],["cant", 9],["video", 9],["lord", 9],["know", 8],["vaccines", 8],["way", 7]],
            "2021": [["vaccine", 112],["covid", 82],["right", 67],["know", 62],["good", 54],["love", 53],["need", 51],["hes", 50],["freedom", 50],["want", 49],["cant", 47],["vaccinated", 46],["anti", 46],["medical", 45],["shes", 40]],
            "2022": [["anti", 46],["covid", 38],["vaccine", 38],["freedom", 36],["mandates", 35],["good", 33],["right", 30],["mandate", 30],["government", 29],["country", 29],["vaccinated", 28],["love", 28],["world", 27],["way", 25],["want", 25]],
            "2023": [["vaccine", 29],["rfk", 28],["sir", 27],["vaccines", 21],["hes", 20],["hai", 19],["day", 17],["dose", 17],["jr", 15],["de", 15],["covid", 13],["good", 12],["debate", 11],["vaccinated", 11],["vote", 11]],
            "2024": [["sir", 17],["vaccine", 13],["hai", 9],["rfk", 8],["right", 7],["kya", 7],["ne", 6],["kids", 5],["covid", 5],["bill", 5],["shoulder", 5],["pe", 5],["dose", 5],["tha", 5],["cant", 4]],
            "2025": [["vaccines", 50],["rfk", 49],["vaccine", 30],["thank", 29],["vaccinated", 28],["covid", 28],["know", 26],["want", 23],["jr", 22],["doctor", 21],["dr", 21],["hes", 21],["bernie", 21],["health", 21],["good", 20]]
        };

        const ctx = document.getElementById('keywordsChart').getContext('2d');
        let chart;

        function renderChart(year) {
            let labels = [];
            let data = [];

            if (year === "all") {
                const combined = {};
                for (const yr in rawData) {
                    rawData[yr].forEach(([keyword, count]) => {
                        combined[keyword] = (combined[keyword] || 0) + count;
                    });
                }

                const sorted = Object.entries(combined).sort((a, b) => b[1] - a[1]).slice(0, 40);
                labels = sorted.map(([k]) => k);
                data = sorted.map(([_, v]) => v);
            } else {
                const yearData = rawData[year];
                labels = yearData.map(item => item[0]);
                data = yearData.map(item => item[1]);
            }

            if (chart) {
                chart.destroy();
            }

            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: `Keyword frequency â€“ ${year === "all" ? "Alle Jahre" : year}`,
                        data: data,
                        backgroundColor: 'green',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            ticks: { color: 'black' },
                            grid: { color: '#ccc' }
                        },
                        y: {
                            ticks: { color: 'black' },
                            grid: { color: '#ccc' }
                        }
                    }
                }
            });
        }

        // Initial rendering
        const yearSelect = document.getElementById('yearSelect');
        renderChart(yearSelect.value);

        // Event listener
        yearSelect.addEventListener('change', () => {
            renderChart(yearSelect.value);
        });
    </script>
</body>
</html>